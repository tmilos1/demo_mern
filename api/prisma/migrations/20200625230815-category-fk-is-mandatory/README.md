# Migration `20200625230815-category-fk-is-mandatory`

This migration has been generated by Milos Tijanic at 6/25/2020, 11:08:15 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Post" (
"body" TEXT NOT NULL  ,"categoryId" INTEGER NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"title" TEXT NOT NULL  ,FOREIGN KEY ("categoryId") REFERENCES "Category"("id") ON DELETE CASCADE ON UPDATE CASCADE)

INSERT INTO "quaint"."new_Post" ("body", "categoryId", "createdAt", "id", "title") SELECT "body", "categoryId", "createdAt", "id", "title" FROM "quaint"."Post"

PRAGMA foreign_keys=off;
DROP TABLE "quaint"."Post";;
PRAGMA foreign_keys=on

ALTER TABLE "quaint"."new_Post" RENAME TO "Post";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200625230403-create-category-table-and-relation-to-posts..20200625230815-category-fk-is-mandatory
--- datamodel.dml
+++ datamodel.dml
@@ -1,21 +1,21 @@
 datasource DS {
   provider = "sqlite"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider      = "prisma-client-js"
   binaryTargets = env("BINARY_TARGET")
 }
 model Post {
-  id         Int       @default(autoincrement()) @id
+  id         Int      @default(autoincrement()) @id
   title      String
   body       String
-  createdAt  DateTime  @default(now())
-  category   Category? @relation(fields: [categoryId], references: [id])
-  categoryId Int?
+  createdAt  DateTime @default(now())
+  category   Category @relation(fields: [categoryId], references: [id])
+  categoryId Int
 }
 model Category {
   id    Int    @default(autoincrement()) @id
```


